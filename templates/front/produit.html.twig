<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="">
    <meta name="author" content="">

    <title>Evento</title>

    <!-- CSS FILES -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="icon" href="{{asset('front/images/tab.png')}}">


    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100;200;400;700&display=swap" rel="stylesheet">

    <link href="{{asset('front/css/bootstrap.min.css')}}" rel="stylesheet">

    <link href="{{asset('front/css/carousel.css')}}" rel="stylesheet">

    <link href="{{asset('front/css/bootstrap-icons.css')}}" rel="stylesheet">

    <link href="{{asset('front/css/templatemo-festava-live.css')}}" rel="stylesheet">

     

    <!--

TemplateMo 583 Festava Live

https://templatemo.com/tm-583-festava-live

-->
</head>

<body>

    <main>

        <header class="site-header">
            <div class="container">
                <div class="row">

                    <div class="col-lg-12 col-12 d-flex flex-wrap">
                        <p class="d-flex me-4 mb-0">
                            <i class="bi-person custom-icon me-2" style="color: black;"></i>
                            <strong class="text-dark">Bienvenue dans Evento !  {% if app.user %}              
                          Vous êtes actuellement connecté en tant que {{ app.user.userIdentifier }}
                    {% endif %} </strong>
                        </p>
                    </div>

                </div>
            </div>
        </header>


        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand" href="index.html">
                    <img src="{{asset('front/images/logo.png')}}" alt="Logo de Evento" style="width: 13%; margin-top: -5px;">
                    Evento
                </a>

                <a href="{{ path('app_login') }}" class="btn custom-btn d-lg-none ms-auto me-4">Se Connecter</a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav align-items-lg-center ms-auto me-lg-5">
                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_1">Accueil</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_2">À propos</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_3">Artistes</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_4">Événement</a>
                        </li>
                
                        <a href="{{ path('produit_front')}}" style="color: white; display: inline-block;">Produits</a>

                    <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_5">Abonnement</a>
                        </li>
                        

                        

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_6">Contact</a>
                        </li>
                    </ul>

                    <a href="{{ path('app_produit_index') }}" class="btn custom-btn d-lg-block d-none">Votre Compte</a>

                </div>
            </div>
        </nav>


<style>
 
 
  .card {
    width: 250px;
    height: 500px;
    margin: 10px;
    padding: 10px;
    border: 1px solid #ccc;
    box-shadow: 0px 0px 5px #ccc;
  }
  
  
  .card-content p {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
    -webkit-line-clamp: 6; /* Nombre de lignes de texte maximum */
  }

  .prix-label {
  display: inline-block; /* pour que le label s'affiche sur la même ligne */
  width: 200px; /* pour définir la largeur du label */
  text-align: left; /* pour aligner le texte à gauche */
  color: white; /* pour changer la couleur du texte */
  margin-right: 10px; /* pour ajouter un espace entre le label et l'élément suivant */
}
    .like-dislike-buttons {
        display: flex;
        align-items: center;
          display: inline-block;

    }

    .like-image,
    .dislike-image {
        display: inline-block;
        width: 30px;
        height: 30px;
        margin-right: 10px;
    }

    .like-image img,
    .dislike-image img {
        width: 100%;
        height: 100%;

        object-fit: cover;
    }


</style>

<section class="schedule-section section-padding" id="section_4">
  <div class="container">
    <div class="row">
      <div class="col-12 text-center">
        <h2 class="text-white mb-4">Nos produits</h2>
        <form id="recherche-produits-form">
          <div class="form-group">
            <label for="recherche-produits-input">Recherche</label>
            <input type="text" class="form-control" id="recherche-produits-input" placeholder="Nom du produit">
            <br>
            <button type="submit" class="btn btn-primary">Rechercher</button>
          </div>
        </form>
        <br>
        <label for="prix-produits-input" class="prix-label">Filtrer par prix (DT):</label>
        <input type="range" class="form-range" min="0" max="10" step="0.1" id="prix-produits-input" oninput="afficherPrix(this.value);">
        <div class="table-responsive">
          <div class="carousel-container">
            <div class="carousel" id="produits-carousel">
              {% for produit in produits %}
              <div class="card-container">
                <div tabindex="0" class="card">
                  <div style="text-align:center;">
                    <img src="{{ asset('uploads/produits/' ~ produit.image) }}" alt="{{ produit.nomProd }}" style="width:200px;">
                  </div>
                  <div class="card-content">
                    <h3 style="font-size: 20px;">{{ produit.getNomProd() }}</h3>
                    <p>{{ produit.getDescription() }}</p>
                    <p>Prix: {{ produit.getPrix() }} DT</p>
                    <div class="like-dislike-buttons" align:center>
                      <a href="{{ path('app_produit_like', {'idProd': produit.idProd}) }}" class="like-image"><img src="front/images/like.png" alt="Like"></a>
                      <span class="like-count">{{ produit.nbLikes }}</span>
                      <a href="{{ path('app_produit_dislike', {'idProd': produit.idProd}) }}" class="dislike-image"><img src="front/images/dislike.png" alt="Dislike"></a>
                      <span class="dislike-count">{{ produit.nbDislikes }}</span>
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
            <br>
            
            <div class="buttons-container">
              <button id="prev-btn" class="btn">Prev</button>
              <button id="next-btn" class="btn">Next</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


 
</section>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
 $(document).ready(function() {
  $('.like-image, .dislike-image').on('click', function(event) {
    event.preventDefault();
    var button = $(this);
    var url = button.attr('href');
    var type = button.hasClass('like-image') ? 'like' : 'dislike';
    $.ajax({
      url: url,
      method: 'POST',
      dataType: 'json',
      data: {type: type}
    }).done(function(data) {
      button.siblings('.like-count').text(data.likes);
      button.siblings('.dislike-count').text(data.dislikes);
      if(type === 'like'){
          button.siblings('.dislike-image').find('.dislike-count').text(data.dislikes);
      } else {
          button.siblings('.like-image').find('.like-count').text(data.likes);
      }
    });
  });
});

</script>


<!-- JavaScript code to trigger AJAX request on slider movement -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Sélection du champ de filtrage par prix
        var priceInput = document.getElementById('prix-produits-input');

        // Événement d'écouteur pour l'événement "input" du champ de filtrage par prix
        priceInput.addEventListener('input', function() {
            // Récupération de la valeur du champ de filtrage par prix
            var priceFilter = priceInput.value;

            // Requête AJAX pour récupérer les produits correspondants au filtre de prix
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        var response = JSON.parse(xhr.responseText);

                        // Effacer les produits précédemment affichés dans le carousel
                        var produitsCarousel = document.getElementById('produits-carousel');
                        while (produitsCarousel.firstChild) {
                            produitsCarousel.removeChild(produitsCarousel.firstChild);
                        }

                        // Boucle pour afficher les produits correspondants au filtre de prix
                        for (var i = 0; i < response.length; i++) {
                            var produit = response[i];

                            // Vérification si le produit correspond au filtre de prix
                            if (produit.prix <= priceFilter) {

                                // Construction de la carte du produit
                                var cardContainer = document.createElement('div');
                                cardContainer.classList.add('card-container');
                                var card = document.createElement('div');
                                card.setAttribute('tabindex', '0');
                                card.classList.add('card');
                                var imageDiv = document.createElement('div');
                                imageDiv.style.textAlign = 'center';
                                var image = document.createElement('img');
                                image.setAttribute('src', "{{ asset('uploads/produits/') }}" + produit.image);
                                image.setAttribute('alt', produit.nomProd);
                                image.style.width = '200px';
                                var cardContent = document.createElement('div');
                                cardContent.classList.add('card-content');
                                var nomProd = document.createElement('h3');
                                nomProd.style.fontSize = '20px';
                                nomProd.textContent = produit.nomProd;
                                var description = document.createElement('p');
                                description.textContent = produit.description;
                                var prix = document.createElement('p');
                                prix.textContent = 'Prix: ' + produit.prix + ' DT';

                                // Ajout des éléments à la carte
                                imageDiv.appendChild(image);
                                cardContent.appendChild(nomProd);
                                cardContent.appendChild(description);
                                cardContent.appendChild(prix);
                                card.appendChild(imageDiv);
                                card.appendChild(cardContent);
                                cardContainer.appendChild(card);

                                // Ajout de la carte au carousel
                                produitsCarousel.appendChild(cardContainer);
                            }
                        }

                    } else {
                        console.error(xhr.responseText);
                    }
                }
            };
            xhr.open('GET', "{{ path('rechercherParPrix') }}?prixMin=" + 0 + "&prixMax=" + priceFilter);
            xhr.send();
        });
    });
</script>


<script>
    document.addEventListener('DOMContentLoaded', function() {
    // Sélection du champ de recherche
    var searchInput = document.getElementById('recherche-produits-input');

    // Événement d'écouteur pour l'événement "input" du champ de recherche
    searchInput.addEventListener('input', function() {
        // Récupération de la valeur du champ de recherche
        var searchTerm = searchInput.value;

        // Requête AJAX pour récupérer les produits correspondants à la recherche
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);

                    // Effacer les produits précédemment affichés dans le carousel
                    var produitsCarousel = document.getElementById('produits-carousel');
                    while (produitsCarousel.firstChild) {
                        produitsCarousel.removeChild(produitsCarousel.firstChild);
                    }

                    // Boucle pour afficher les produits correspondants à la recherche
                    for (var i = 0; i < response.length; i++) {
                        var produit = response[i];

                        // Construction de la carte du produit
                        var cardContainer = document.createElement('div');
                        cardContainer.classList.add('card-container');
                        var card = document.createElement('div');
                        card.setAttribute('tabindex', '0');
                        card.classList.add('card');
                        var imageDiv = document.createElement('div');
                        imageDiv.style.textAlign = 'center';
                        var image = document.createElement('img');
                        image.setAttribute('src', "{{ asset('uploads/produits/') }}" + produit.image);
                        image.setAttribute('alt', produit.nomProd);
                        image.style.width = '200px';
                        var cardContent = document.createElement('div');
                        cardContent.classList.add('card-content');
                        var nomProd = document.createElement('h3');
                        nomProd.style.fontSize = '20px';
                        nomProd.textContent = produit.nomProd;
                        var description = document.createElement('p');
                        description.textContent = produit.description;
                        var prix = document.createElement('p');
                        prix.textContent = 'Prix: ' + produit.prix + ' DT';

                        // Ajout des éléments à la carte
                        imageDiv.appendChild(image);
                        cardContent.appendChild(nomProd);
                        cardContent.appendChild(description);
                        cardContent.appendChild(prix);
                        card.appendChild(imageDiv);
                        card.appendChild(cardContent);
                        cardContainer.appendChild(card);

                        // Ajout de la carte au carousel
                        produitsCarousel.appendChild(cardContainer);
                    }

                } else {
                    console.error(xhr.responseText);
                }
            }
        };
        xhr.open('GET', "{{ path('rechercherParNom') }}?term=" + searchTerm);
        xhr.send();
        });
        });


    </script>


 </main>


    <footer class="site-footer">
        <div class="site-footer-top">
            <div class="container">
                <div class="row">

                    <div class="col-lg-6 col-12">
                        <h2 class="text-white mb-lg-0">Evento</h2>
                    </div>

                    <div class="col-lg-6 col-12 d-flex justify-content-lg-end align-items-center">
                        <ul class="social-icon d-flex justify-content-lg-end">
                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-twitter"></span>
                                </a>
                            </li>

                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-apple"></span>
                                </a>
                            </li>

                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-instagram"></span>
                                </a>
                            </li>

                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-youtube"></span>
                                </a>
                            </li>

                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-pinterest"></span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">

                <div class="col-lg-6 col-12 mb-4 pb-2">
                    <h5 class="site-footer-title mb-3">Liens</h5>

                    <ul class="site-footer-links">
                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Accueil</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">À propos</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Artistes</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Événement</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Abonnement</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Contact</a>
                        </li>
                    </ul>
                </div>

                <div class="col-lg-3 col-md-6 col-12 mb-4 mb-lg-0">
                    <h5 class="site-footer-title mb-3">Tu as une question ?</h5>

                    <p class="text-white d-flex mb-1">
                        <a href="tel: 090-080-0760" class="site-footer-link">
                            090-080-0760
                        </a>
                    </p>

                    <p class="text-white d-flex">
                        <a href="mailto:pidevtestapp@gmail.com" class="site-footer-link">
                            pidevtestapp@gmail.com
                        </a>
                    </p>
                </div>

                <div class="col-lg-3 col-md-6 col-11 mb-4 mb-lg-0 mb-md-0">
                    <h5 class="site-footer-title mb-3">Location</h5>

                    <p class="text-white d-flex mt-3 mb-2">
                        18, rue de l'Usine - ZI Aéroport Charguia II 2035 Ariana </p>

                    <a class="link-fx-1 color-contrast-higher mt-3" href="#">
                        <span>Notre carte</span>
                        <svg class="icon" viewBox="0 0 32 32" aria-hidden="true">
                            <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="16" cy="16" r="15.5"></circle>
                                <line x1="10" y1="18" x2="16" y2="12"></line>
                                <line x1="16" y1="12" x2="22" y2="18"></line>
                            </g>
                        </svg>
                    </a>
                </div>
            </div>
        </div>

    </footer>

    <!--

T e m p l a t e M o

-->

    <!-- JAVASCRIPT FILES -->
    <script src="{{asset('front/js/jquery.min.js')}}"></script>
    <script src="{{asset('front/js/carousel.js')}}"></script>
    <script src="{{asset('front/js/bootstrap.min.js')}}"></script>
    <script src="{{asset('front/js/jquery.sticky.js')}}"></script>
    <script src="{{asset('front/js/click-scroll.js')}}"></script>
    <script src="{{asset('front/js/custom.js')}}"></script>

</body>

</html>